S.SSCL.Games=Backbone.Collection.extend({model:S.SSMO.Game,initialize:function(){_.bindAll(this,"parse")},parse:function(a){return a.data}});S.SSCT.Game=Backbone.Controller.extend({initialize:function(){_.bindAll(this)},validate:function(a,b){this.validModel=S.SSCT.GetHandler("Model","ValidCode");this.validModel.on("error",_.bind(function(a,d){b.error(d.msg||d);this.validModel.off("error")},this));this.validModel.set({alphaCode:a})&&this.validModel.validCode({alphaCode:a},{success:b.success,error:function(a,d){console.log("resp",d);b.error(d.msg)}})},getGameInfo:function(a){if(null==this.gameId){var b=S.sdkBase.request(S.sdkBase.servType.COMMON,
S.sdkBase.actions.GET_GAME_INFO);b&&b.success?(this.gameId=b.data.gameId,this.gameInfo=b.data,a&&a.success&&a.success.apply(this,[b.data])):a&&a.error&&a.error.apply(this,[b])}else!_.isUndefined(a)&&!_.isUndefined(a.success)&&_.isFunction(a.success)&&a.success.apply(this,[this.gameInfo])}});S.SSMO.Game=Backbone.Model.extend({initialize:function(){}});S.SSMO.ValidCode=Backbone.Model.extend({initialize:function(){_.bindAll(this);this.url=S.sdkBase.servType.SDKSERVER+"/"+S.sdkBase.actions.CALL_SDK_SERVER+"/"+rConfig.apis.VALID_CODE},validate:function(a){if(!this.isRequest){if(_.isUndefined(a.alphaCode)&&_.isEmpty(a.alphaCode))return"\u6fc0\u6d3b\u7801\u4e0d\u80fd\u4e3a\u7a7a";if(6!=a.alphaCode.length||a.alphaCode.match(/[^a-z0-9A-Z]+/))return"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6fc0\u6d3b\u7801"}this.isRequest=!1},validCode:function(a,b){this.save(a,
b)},parse:function(a){this.isRequest=!0;return a.data}});S.SSVW.Game=Backbone.View.extend({el:"#gameContainer",events:{"onclick #bbsLink":"linkToBBS","onclick #gameCenterLink":"linkToGameCenter","onclick #confirmValidCode":"doConfirm","onclick #exitValidCode":"doExit","onclick #clearCode":"flushInpt","onclick #clearValidCode":"clearValidCode","onclick #validCode":"_inputFocuse","focusout #validCode":"hideClrPass"},isRandom:null,initialize:function(){_.bindAll(this);this.gameController=S.SSCT.GetHandler("Controller","Game")},notOpen:function(){S.SCEV.Proxy.trigger(S.SCEV.EventType.PRE_ROUTE,
{enterPage:sdk.Log.businesses.PAGE_GAME,enterBusiness:["notOpen"]})},validCode:function(a){S.SCEV.Proxy.trigger(S.SCEV.EventType.PRE_ROUTE,{enterPage:sdk.Log.businesses.PAGE_GAME,enterBusiness:["validateCode"]});this.isRandom=!_.isUndefined(a)&&!_.isEmpty(a)?a:"false";this.changeClrPass();this.initLogoutBtn()},doConfirm:function(){var a=this,b=this.$el.find("#validCode").val(),c=S.SSCT.GetHandler("Controller","User");this.$el.find("#confirmValidCode").attr("disabled","disabled");this.$el.find("#confirmValidCode").attr("data-disabled",
"true").addClass("ui-disabled");this.gameController.validate(b,this.gameController.callBackMix(function(b,e){"true"===a.isRandom?sdk.Url.redirect("../user/user.html#!user/updatePassword/true"):c.notifyCp({code:e.code,msg:e.msg},c.callBackMix(c.sdkExit))},function(b){a._showErrorMsg(b,"#validCodeNoticeBox");a.$el.find("#confirmValidCode").removeAttr("disabled");a.$el.find("#confirmValidCode").attr("data-disabled","").removeClass("ui-disabled")}))},doExit:function(){S.Log.pageClose();S.SSCT.GetHandler("Controller",
"User").sdkExit()},flushInpt:function(){!_.isUndefined(this.noticeBar)&&!_.isEmpty(this.noticeBar)&&sdk.common.ui.NoticeBox.hide(this.noticeBar,null,"slide");this.$el.find("#validCode").val("")},clearValidCode:function(){this.$el.find("#validCode").val("");this.changeClrPass()},changeClrPass:function(){_.isEmpty($("#validCode").val())?$("#clearValidCode").hide():$("#clearValidCode").show()},hideClrPass:function(){$("#clearValidCode").hide()},initLogoutBtn:function(){S.SCEV.Proxy.trigger(S.SCEV.EventType.SDK_REMOVE_WIN_EVENT,
{eventName:"bridgeTopBtnClicked"});S.SCEV.Proxy.trigger(S.SCEV.EventType.SDK_WINDOW_EVENT,{eventName:"bridgeTopBtnClicked",handler:function(a){"logout"==a.action&&(S.sdkBase.request(S.sdkBase.servType.LOGIN,S.sdkBase.actions.LOGOUT),S.SSCT.GetHandler("Controller","User").sdkExit())}})},linkToBBS:function(){sdk.Log.pageEnter(sdk.Log.businesses.PAGE_GAME,["bbsClick"]);sdk.Log.pageClose(sdk.Log.businesses.PAGE_GAME,["bbsClick"]);sdk.PageCache.set("sdk_redirect_out",1);S.Url.redirect("../bbs/bbs.html")},
linkToGameCenter:function(){sdk.Log.pageClose(sdk.Log.businesses.PAGE_GAME,["notOpen"]);sdk.Log.pageEnter(sdk.Log.businesses.PAGE_GAME,["gameCenter"]);S.Url.redirect(eConfig.gameCenter)},_inputFocuse:function(){this.changeClrPass()},_showErrorMsg:function(a,b,c){S.SSCT.GetHandler("Controller","General").sendClientMsg(a);c&&c.apply()}});
