var Route=function(){var g=!1,j=[],h=[],c=function(){_bindRoutes=function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);for(b=a.length-1;0<=b;b--)this.route(a[b][0],a[b][1],this[a[b][1]],this)}};_bindRoutes.call(this);this.initialize()};c.routeInit=function(a){try{new window[a+"Route"]}catch(b){return}c.start()};c.start=function(){if(!g){var a=this,b=function(){this.trigger(window.location.hash.replace(f.routeStripper,""));c.triggerHashEvent()};"onhashchange"in window?
window.onhashchange=function(){b.call(a.prototype)}:setInterval(function(){var d=window.location.hash;if(d!=a.fragment)a.fragment=d,b.call(a.prototype)},50);this.fragment=window.location.hash;b.call(this.prototype);return g=!0}return!1};c.triggerHashEvent=function(){for(var a=window.location.hash,b=c.hashSplit(a),d,i=h.length-1;0<=i;i--)(d=h[i].callback)&&"function"===typeof d&&d.apply(this,[a,b])};c.hashSplit=function(a){return a.replace(f.paramStripper,"").split("/")};c.register=function(a,b){h.push({callback:b,
name:a});g&&c.triggerHashEvent()};c.extend=function(a){var b=function(){for(var b in a)this[b]=a[b];c.call(this)};b.prototype=c.prototype;return b};c.prototype.route=function(a,b,d,c){a instanceof RegExp||(a=f._routeToRegExp(a));d||(d=this[b]);this.listen(a,b,f.bind(function(b){b=f._extractParameters(a,b);if(d)return d.apply(this,b)},this),c)};c.prototype.listen=function(a,b,d,c){j.push({route:a,name:b,callback:d,routeModel:c})};c.prototype.trigger=function(a){var b;f.any(j,function(d){if(d.route.test(a)){var c=
d.routeModel.beforeRoute,e=d.routeModel.afterRoute;c&&c.call(d.routeModel);d.callback(a);e&&e.call(d.routeModel);b={name:d.name};return!0}});return b};var f={namedParam:/:\w+/g,splatParam:/\*\w+/g,escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,routeStripper:/^[#\/]/,paramStripper:/^#!/,_routeToRegExp:function(a){a=""!=a?a.replace(this.escapeRegExp,"\\$&").replace(this.namedParam,"([^/]+)").replace(this.splatParam,"(.*?)"):a;return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)},
isRegExp:function(a){return a instanceof RegExp},bind:function(a,b){return a.bind?Function.bind.apply(a,Array.prototype.slice.call(arguments,1)):function(d){a.call(b,d)}},any:function(a,b,d){var c=!1;if(null==a)return c;if(a.some)return a.some(b,d);for(var e=a.length-1;0<=e&&!c&&!(c=b.call(d,a[e],e));e--);return!!c}};return c}();
